C51 COMPILER V9.60.7.0   APP_KEYS                                                          01/05/2026 22:26:27 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE APP_KEYS
OBJECT MODULE PLACED IN .\Objects\App_Keys.obj
COMPILER INVOKED BY: E:\AAAAAA\Keil_v5\C51\BIN\C51.EXE App\App_Keys.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(.\User;.\Lib
                    -;.\Hardware;.\App;.\Bare-MetalMultitasking;.\Hardware\I2Csoft_oled) DEBUG OBJECTEXTEND PRINT(.\Listings\App_Keys.lst) OB
                    -JECT(.\Objects\App_Keys.obj)

line level    source

   1          #include "App.h"
   2          
   3          void App_Keys_task(){
   4   1          Keys_scan();
   5   1          P07_Btn();
   6   1      }
   7          
   8          //  0  1  2  3  //ÏµÍ³¿ªÊ¼¸ø³öµÄ²Î¿¼
   9          //  4  5  6  7
  10          //  8  9 10 11
  11          // 12 13 14 15
  12          // 16 17 18 19
  13          // 20 21 22 23
  14          // 24 25 26 27
  15          
  16          extern u32 sys_ms;
  17          char g_current_color = 0;       
  18            u8 g_current_pos       = 4;   
  19            u8 g_current_line  = 1;
  20          
  21          
  22          // ÐèÒªÏÞ¶¨·¶Î§ Ã¿Ò»¸öroundÖ»ÈÃÄãÔÚÍ¬Ò»ÐÐ£¨4¸öµÆ·¶Î§ÄÚÒÆ¶¯£©
  23          #define current_move_min  (g_current_line * 4)// 4 8 12 16 20 24
  24          #define current_move_max  ((g_current_line * 4) + 3)
  25          
  26          
  27          void Keys_on_keydown(u8 key){
  28   1          u32 cur_ms = 0;
  29   1      //    DeviceStandBy
  30   1          if(DeviceState == DeviceDefault){   // ³õÊ¼×´Ì¬       
  31   2                  Device_Default2LevelSW(key);
  32   2                  return;
  33   2          }   
  34   1          
  35   1          if(DeviceState == DeviceLevelSW){   // Ñ¡ÔñÄÑ¶È×´Ì¬
  36   2                  Device_LevelSW2DeviceLvSwitch(key);
  37   2                  return;
  38   2          }           
  39   1      
  40   1          if(DeviceState == DeviceLvSwitch){  // Ñ¡Ôñ¹Ø¿¨×´Ì¬
  41   2                  Device_LvSwitch2Start(key);
  42   2                  return;
  43   2          }   
  44   1          
  45   1          if(DeviceState == DeviceStart){         // ÓÎÍæ×´Ì¬
  46   2                  if(key == 0){                                               
  47   3                          g_current_pos--;
  48   3                          if(g_current_pos < current_move_min)  g_current_pos = current_move_min;
  49   3                          if(g_current_pos > current_move_max)  g_current_pos = current_move_max;
  50   3                          
  51   3                          g_color_array[g_current_pos] = g_current_color;
  52   3                          WS2812_WriteColor2Array(ANS, g_current_pos, g_current_color);
  53   3                          WS2812_WriteColor2Array(POS, g_current_pos+1, 7);
C51 COMPILER V9.60.7.0   APP_KEYS                                                          01/05/2026 22:26:27 PAGE 2   

  54   3                          WS2812_WriteColor2Array(POS, g_current_pos, g_current_color);
  55   3                  }
  56   2                  if(key == 2){
  57   3                          g_current_pos++;
  58   3                          if(g_current_pos < current_move_min)  g_current_pos = current_move_min;
  59   3                          if(g_current_pos > current_move_max)  g_current_pos = current_move_max;
  60   3                      
  61   3                          g_color_array[g_current_pos] = g_current_color;
  62   3                          WS2812_WriteColor2Array(ANS, g_current_pos, g_current_color);
  63   3                          WS2812_WriteColor2Array(POS, g_current_pos-1, 7);
  64   3                          WS2812_WriteColor2Array(POS, g_current_pos, g_current_color);
  65   3                  }
  66   2                  
  67   2                  if(key == 1){
  68   3                          g_current_color++;
  69   3                          if(g_current_color<0) g_current_color = 6;
  70   3                          if(g_current_color>6) g_current_color = 0;
  71   3                      
  72   3                          g_color_array[g_current_pos] = g_current_color;
  73   3                          WS2812_WriteColor2Array(ANS, g_current_pos, g_current_color);
  74   3                          WS2812_WriteColor2Array(POS, g_current_pos, g_current_color);
  75   3                  }
  76   2                  if(key == 3){
  77   3                          g_current_color--;
  78   3                          if(g_current_color<0) g_current_color = 6;
  79   3                          if(g_current_color>6) g_current_color = 0;
  80   3                      
  81   3                          g_color_array[g_current_pos] = g_current_color;
  82   3                          WS2812_WriteColor2Array(ANS, g_current_pos, g_current_color);
  83   3                          WS2812_WriteColor2Array(POS, g_current_pos, g_current_color);
  84   3                  }
  85   2                  
  86   2                  if(key == 4){
  87   3                          WS2812_WriteColor2Array(POS, g_current_pos, 7); // ÒòÎªÒª»»ÐÐ£¬ËùÒÔÇå³ýµ±Ç°POSµÄÎ»ÖÃÑÕ
             -É«
  88   3                          if(LevelSwitch == 1)        GuessColorLv1(Lv1Lvsw - 1);         // ÅÐ¶Ï ¹Ø¿¨1 £¨Õâ¸ö¹ý³ÌÖÐ»á¸ø¸ù¾
             -ÝANS¸øPOSÊý×éÐ´ÑÕÉ«£¨Ã»ÓÐ·¢ËÍ£©£©
  89   3                          else if(LevelSwitch == 2)   GuessColorLv2(Lv2Lvsw - 1);
  90   3                          else if(LevelSwitch == 3)   GuessColorLv3(Lv3Lvsw - 1);
  91   3                          // ¹Ø¿¨Ê¤Àû×´Ì¬
  92   3                          if(DeviceState == DeviceVictory){ 
  93   4                              OLED_Clear();
  94   4                              App_OLED_refresh();
  95   4                              
  96   4                              DeviceState = DeviceDefault;
  97   4                              
  98   4                              // ÕâÀïÏÈÉÏËøTASK Ó²¿¨ËÀµÈ´ýÒ»»á£¨2Ãë×óÓÒ£©
  99   4                              Task_Lock();
 100   4                              cur_ms = sys_ms;
 101   4                              while((sys_ms - cur_ms)<1000);
 102   4                              Task_Unlock();
 103   4                              
 104   4                              return;
 105   4                          }           
 106   3                          // ¹Ø¿¨Ê§°Ü×´Ì¬£¨6´ÎÃ»²Â³öÀ´£©
 107   3                          if(g_current_line == 6){
 108   4                              //printf("6´ÎÒÑÂú\n");
 109   4                          
 110   4                              DeviceState = DeviceDefeat;
 111   4                              OLED_Clear();
 112   4                              App_OLED_refresh();
 113   4                              DeviceState = DeviceDefault;
C51 COMPILER V9.60.7.0   APP_KEYS                                                          01/05/2026 22:26:27 PAGE 3   

 114   4                          
 115   4                              return; // ³¬¹ý6´Î
 116   4                          }
 117   3                      
 118   3                          g_current_line++;   // ÈÃÓÎÏ·µÄÐÐÊý+1       ÏÂÃæÕâÐÐÊÇÐÞ¸ÄÒÆ¶¯ÁÙ½çÖµ
 119   3                          if(g_current_pos < current_move_min)  g_current_pos = current_move_min;
 120   3                          
 121   3                          g_color_array[g_current_pos] = g_current_color;// °Ñµ±Ç°ÑÕÉ«Ð´Èëµ±Ç°Î»ÖÃ ÐÞ¸ÄÒÆ¶¯ÁÙ½çÖ
             -µÖ®ºóÎ»ÖÃÇÐ»»ÁË£¬ËùÒÔÒªÐ´ÈëÒ»´Î
 122   3                          WS2812_WriteColor2Array(ANS, g_current_pos, g_current_color);// °Ñµ±Ç°ÑÕÉ«Ð´ÈëANS POSÊ
             -ý×é
 123   3                          WS2812_WriteColor2Array(POS, g_current_pos, g_current_color);
 124   3                          
 125   3                  }
 126   2                  WS2812_RefreshLEDColor(0);
 127   2                  WS2812_RefreshLEDColor(1);
 128   2          }
 129   1      }
 130          
 131          //void Keys_on_keyup(u8 key){
 132          //    printf("KEY[%d] UP\n",(int)key);
 133          //}


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    757    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      3       3
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
